{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils.js","webpack:///./node_modules/dom-utils/lib/matches.js","webpack:///./node_modules/dom-utils/lib/parents.js","webpack:///./node_modules/dom-utils/lib/closest.js","webpack:///./node_modules/dom-utils/lib/delegate.js","webpack:///./node_modules/dom-utils/lib/dispatch.js","webpack:///./node_modules/dom-utils/lib/get-attributes.js","webpack:///./node_modules/dom-utils/lib/parse-url.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/lodash.throttle/index.js","webpack:///./node_modules/element-in-view/dist/element-in-view.common.js","webpack:///./src/legacy.js","webpack:///./node_modules/intersection-observer/intersection-observer.js","webpack:///./src/tracker/view-listener.js","webpack:///./src/tracker/event-transport.js","webpack:///./src/tracker/link-listener.js","webpack:///./src/tracker/index.js","webpack:///./src/app.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","t","e","withTimeout","callback","wait","arguments","length","wasCalled","fn","setTimeout","buildQuery","obj","keys","filter","k","map","encodeURIComponent","join","domReady","document","readyState","addEventListener","removeEventListener","extractFieldsFrom","node","nodeType","data","getAttribute","JSON","parse","decodeURIComponent","isTrackable","action","assign","target","_arguments","_loop","len","source","forEach","key","proto","window","Element","nativeMatches","matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","element","test","item","selector","nodes","parentNode","querySelectorAll","parents","list","push","closest_closest","shouldCheckSelf","parentElements","concat","parent","delegate_delegate","ancestor","eventType","opts","listener","event","delegateTarget","composed","composedPath","useCapture","destroy","dispatch","eventName","initDict","isCustom","bubbles","cancelable","err","createEvent","detail","dispatchEvent","getAttributes","attrs","attributes","attr","HTTP_PORT","HTTPS_PORT","DEFAULT_PORT","RegExp","a","createElement","cache","parseUrl","url","location","href","charAt","port","host","replace","origin","protocol","pathname","hash","hostname","search","g","this","Function","eval","global","FUNC_ERROR_TEXT","NAN","NaN","symbolTag","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","freeGlobal","freeSelf","self","root","objectToString","toString","nativeMax","Math","max","nativeMin","min","now","Date","isObject","type","toNumber","other","valueOf","isBinary","slice","func","options","leading","trailing","TypeError","lastArgs","lastThis","maxWait","result","timerId","lastCallTime","lastInvokeTime","maxing","invokeFunc","time","args","thisArg","apply","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","debounced","isInvoking","cancel","clearTimeout","flush","debounce","ref","offset","threshold","ref$1","getBoundingClientRect","top","right","bottom","left","width","height","intersection","innerWidth","innerHeight","elementThreshold","getPendingElements","loadBeacon","_elementInView2","setAttribute","src","qs","Image","handler","_lodash2","MutationObserver","mutations","mutation","Array","addedNodes","Node","ELEMENT_NODE","observe","body","childList","subtree","IntersectionObserverEntry","intersectionRatio","registry","IntersectionObserver","THROTTLE_TIMEOUT","POLL_INTERVAL","USE_MUTATION_OBSERVER","_observationTargets","some","Error","_registerInstance","entry","_monitorIntersections","_checkForIntersections","unobserve","_unmonitorIntersections","_unregisterInstance","disconnect","takeRecords","records","_queuedEntries","_initThresholds","opt_threshold","isArray","sort","isNaN","_parseRootMargin","opt_rootMargin","margins","split","margin","parts","exec","parseFloat","unit","_monitoringIntersections","_monitoringInterval","setInterval","addEvent","_domObserver","characterData","clearInterval","removeEvent","rootIsInDom","_rootIsInDom","rootRect","_getRootRect","targetRect","rootContainsTarget","_rootContainsTarget","oldEntry","intersectionRect","_computeTargetAndRootIntersection","newEntry","performance","boundingClientRect","rootBounds","_hasCrossedThreshold","isIntersecting","_callback","getComputedStyle","display","rect1","rect2","getParentNode","atRoot","parentRect","parentComputedStyle","documentElement","overflow","html","clientWidth","clientHeight","_expandRectByRootMargin","rect","_rootMarginValues","newRect","oldRatio","newRatio","thresholds","containsDeep","indexOf","index","splice","targetArea","intersectionArea","opt_options","timeout","timer","bind","rootMargin","opt_useCapture","attachEvent","detatchEvent","el","child","_utils","isVisible","record","ViewListener","tracker","_this","trackOnce","handleIntersection","handleMutations","handleAddedElement","handleRemovedElement","mutationObserver","intersectionObserver","observeElements","_this2","getElements","requestAnimationFrame","elementMap","sendEvent","_this3","removedNodes","removed","walkTree","added","childNodes","fields","execute","transport","unobserveAllElements","domain","EventTransport","defaults","_ref","pid","cid","uuid","_ref2","act","String","trim","toLowerCase","params","_","getTime","query","endpoint","createUrl","navigator","sendBeacon","img","onload","onerror","_domUtils","LinkListener","enabled","events","shouldTrackLink","handleInteractions","delegates","delegate","link","eventOpts","metaKey","ctrlKey","shiftKey","altKey","which","defaultPrevented","preventDefault","original","urlParser","listeners","Tracker","trackLinks","debug","onLinkTrack","_eventTransport2","commands","send","_linkListener2","_viewListener2","command","_commands","_console","_len","_key","console","info","_tracker","from","queueName","FortnightObject","queue","q","_app2","_toConsumableArray"],"mappings":"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","file":"fortnight.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n","\n/**\n * Returns a wrapped version of the provided function.\n * If it's not called when the timeout is reached, it will be called regardless.\n * The wrapped function will also be prevented from being called more than once.\n *\n * @param {Function} callback\n * @param {number} wait\n * @return {Function}\n */\nexport function withTimeout(callback, wait = 2000) {\n  let wasCalled = false;\n  const fn = (...args) => {\n    if (!wasCalled) {\n      wasCalled = true;\n      callback(...args);\n    }\n  };\n  setTimeout(fn, wait);\n  return fn;\n}\n\n/**\n * A simplified shim of Object.assign.\n *\n * @param {Object} target\n * @param {...Object} sources\n * @return {Object}\n */\nexport const assign = Object.assign || function assign(target, ...sources) {\n  for (let i = 0, len = sources.length; i < len; i += 1) {\n    const source = Object(sources[i]);\n    Object.keys(source).forEach((key) => {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        // eslint-disable-next-line no-param-reassign\n        target[key] = source[key];\n      }\n    });\n  }\n  return target;\n};\n\n/**\n * Builds a simply query string from object.\n *\n * @param {object} obj\n * @return {string}\n */\nexport function buildQuery(obj) {\n  return Object.keys(obj).filter(k => obj[k]).map(k => `${encodeURIComponent(k)}=${encodeURIComponent(obj[k])}`).join('&');\n}\n\n/**\n * Will invoke the provided function when the DOM is ready.\n * If already ready, the callback will be invoked immediately.\n *\n * @param {Function} callback The ready callback.\n */\nexport function domReady(callback) {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function fn() {\n      document.removeEventListener('DOMContentLoaded', fn);\n      callback();\n    });\n  } else {\n    callback();\n  }\n}\n\n/**\n * Extracts an event fields object from a node.\n *\n * @param {DOMNode} node\n * @param {string} attrName\n * @return {object}\n */\nexport function extractFieldsFrom(node) {\n  if (node.nodeType !== 1) return {};\n  const data = node.getAttribute('data-fortnight-fields');\n  if (!data) return {};\n  try {\n    return JSON.parse(decodeURIComponent(data)) || {};\n  } catch (e) {\n    return {};\n  }\n}\n\n/**\n * Determines if a node is trackable for the provided action.\n *\n * @param {DOMNode} node\n * @param {string} action\n * @return {boolean}\n */\nexport function isTrackable(node, action) {\n  if (node.nodeType !== 1) return false;\n  const value = node.getAttribute('data-fortnight-action');\n  return action === value;\n}\n","const proto = window.Element.prototype;\nconst nativeMatches = proto.matches ||\n      proto.matchesSelector ||\n      proto.webkitMatchesSelector ||\n      proto.mozMatchesSelector ||\n      proto.msMatchesSelector ||\n      proto.oMatchesSelector;\n\n\n/**\n * Tests if a DOM elements matches any of the test DOM elements or selectors.\n * @param {Element} element The DOM element to test.\n * @param {Element|string|Array<Element|string>} test A DOM element, a CSS\n *     selector, or an array of DOM elements or CSS selectors to match against.\n * @return {boolean} True of any part of the test matches.\n */\nexport default function matches(element, test) {\n  // Validate input.\n  if (element && element.nodeType == 1 && test) {\n    // if test is a string or DOM element test it.\n    if (typeof test == 'string' || test.nodeType == 1) {\n      return element == test ||\n          matchesSelector(element, /** @type {string} */ (test));\n    } else if ('length' in test) {\n      // if it has a length property iterate over the items\n      // and return true if any match.\n      for (let i = 0, item; item = test[i]; i++) {\n        if (element == item || matchesSelector(element, item)) return true;\n      }\n    }\n  }\n  // Still here? Return false\n  return false;\n}\n\n\n/**\n * Tests whether a DOM element matches a selector. This polyfills the native\n * Element.prototype.matches method across browsers.\n * @param {!Element} element The DOM element to test.\n * @param {string} selector The CSS selector to test element against.\n * @return {boolean} True if the selector matches.\n */\nfunction matchesSelector(element, selector) {\n  if (typeof selector != 'string') return false;\n  if (nativeMatches) return nativeMatches.call(element, selector);\n  const nodes = element.parentNode.querySelectorAll(selector);\n  for (let i = 0, node; node = nodes[i]; i++) {\n    if (node == element) return true;\n  }\n  return false;\n}\n","/**\n * Returns an array of a DOM element's parent elements.\n * @param {!Element} element The DOM element whose parents to get.\n * @return {!Array} An array of all parent elemets, or an empty array if no\n *     parent elements are found.\n */\nexport default function parents(element) {\n  const list = [];\n  while (element && element.parentNode && element.parentNode.nodeType == 1) {\n    element = /** @type {!Element} */ (element.parentNode);\n    list.push(element);\n  }\n  return list;\n}\n","import matches from './matches';\nimport parents from './parents';\n\n/**\n * Gets the closest parent element that matches the passed selector.\n * @param {Element} element The element whose parents to check.\n * @param {string} selector The CSS selector to match against.\n * @param {boolean=} shouldCheckSelf True if the selector should test against\n *     the passed element itself.\n * @return {Element|undefined} The matching element or undefined.\n */\nexport default function closest(element, selector, shouldCheckSelf = false) {\n  if (!(element && element.nodeType == 1 && selector)) return;\n  const parentElements =\n      (shouldCheckSelf ? [element] : []).concat(parents(element));\n\n  for (let i = 0, parent; parent = parentElements[i]; i++) {\n    if (matches(parent, selector)) return parent;\n  }\n}\n","import closest from './closest';\nimport matches from './matches';\n\n/**\n * Delegates the handling of events for an element matching a selector to an\n * ancestor of the matching element.\n * @param {!Node} ancestor The ancestor element to add the listener to.\n * @param {string} eventType The event type to listen to.\n * @param {string} selector A CSS selector to match against child elements.\n * @param {!Function} callback A function to run any time the event happens.\n * @param {Object=} opts A configuration options object. The available options:\n *     - useCapture<boolean>: If true, bind to the event capture phase.\n *     - deep<boolean>: If true, delegate into shadow trees.\n * @return {Object} The delegate object. It contains a destroy method.\n */\nexport default function delegate(\n    ancestor, eventType, selector, callback, opts = {}) {\n  // Defines the event listener.\n  const listener = function(event) {\n    let delegateTarget;\n\n    // If opts.composed is true and the event originated from inside a Shadow\n    // tree, check the composed path nodes.\n    if (opts.composed && typeof event.composedPath == 'function') {\n      const composedPath = event.composedPath();\n      for (let i = 0, node; node = composedPath[i]; i++) {\n        if (node.nodeType == 1 && matches(node, selector)) {\n          delegateTarget = node;\n        }\n      }\n    } else {\n      // Otherwise check the parents.\n      delegateTarget = closest(event.target, selector, true);\n    }\n\n    if (delegateTarget) {\n      callback.call(delegateTarget, event, delegateTarget);\n    }\n  };\n\n  ancestor.addEventListener(eventType, listener, opts.useCapture);\n\n  return {\n    destroy: function() {\n      ancestor.removeEventListener(eventType, listener, opts.useCapture);\n    },\n  };\n}\n","/**\n * Dispatches an event on the passed element.\n * @param {!Element} element The DOM element to dispatch the event on.\n * @param {string} eventType The type of event to dispatch.\n * @param {Object|string=} eventName A string name of the event constructor\n *     to use. Defaults to 'Event' if nothing is passed or 'CustomEvent' if\n *     a value is set on `initDict.detail`. If eventName is given an object\n *     it is assumed to be initDict and thus reassigned.\n * @param {Object=} initDict The initialization attributes for the\n *     event. A `detail` property can be used here to pass custom data.\n * @return {boolean} The return value of `element.dispatchEvent`, which will\n *     be false if any of the event listeners called `preventDefault`.\n */\nexport default function dispatch(\n    element, eventType, eventName = 'Event', initDict = {}) {\n  let event;\n  let isCustom;\n\n  // eventName is optional\n  if (typeof eventName == 'object') {\n    initDict = eventName;\n    eventName = 'Event';\n  }\n\n  initDict.bubbles = initDict.bubbles || false;\n  initDict.cancelable = initDict.cancelable || false;\n  initDict.composed = initDict.composed || false;\n\n  // If a detail property is passed, this is a custom event.\n  if ('detail' in initDict) isCustom = true;\n  eventName = isCustom ? 'CustomEvent' : eventName;\n\n  // Tries to create the event using constructors, if that doesn't work,\n  // fallback to `document.createEvent()`.\n  try {\n    event = new window[eventName](eventType, initDict);\n  } catch(err) {\n    event = document.createEvent(eventName);\n    const initMethod = 'init' + (isCustom ? 'Custom' : '') + 'Event';\n    event[initMethod](eventType, initDict.bubbles,\n                      initDict.cancelable, initDict.detail);\n  }\n\n  return element.dispatchEvent(event);\n}\n","/**\n * Gets all attributes of an element as a plain JavaScriot object.\n * @param {Element} element The element whose attributes to get.\n * @return {!Object} An object whose keys are the attribute keys and whose\n *     values are the attribute values. If no attributes exist, an empty\n *     object is returned.\n */\nexport default function getAttributes(element) {\n  const attrs = {};\n\n  // Validate input.\n  if (!(element && element.nodeType == 1)) return attrs;\n\n  // Return an empty object if there are no attributes.\n  const map = element.attributes;\n  if (map.length === 0) return {};\n\n  for (let i = 0, attr; attr = map[i]; i++) {\n    attrs[attr.name] = attr.value;\n  }\n  return attrs;\n}\n","const HTTP_PORT = '80';\nconst HTTPS_PORT = '443';\nconst DEFAULT_PORT = RegExp(':(' + HTTP_PORT + '|' + HTTPS_PORT + ')$');\n\n\nconst a = document.createElement('a');\nconst cache = {};\n\n\n/**\n * Parses the given url and returns an object mimicing a `Location` object.\n * @param {string} url The url to parse.\n * @return {!Object} An object with the same properties as a `Location`.\n */\nexport default function parseUrl(url) {\n  // All falsy values (as well as \".\") should map to the current URL.\n  url = (!url || url == '.') ? location.href : url;\n\n  if (cache[url]) return cache[url];\n\n  a.href = url;\n\n  // When parsing file relative paths (e.g. `../index.html`), IE will correctly\n  // resolve the `href` property but will keep the `..` in the `path` property.\n  // It will also not include the `host` or `hostname` properties. Furthermore,\n  // IE will sometimes return no protocol or just a colon, especially for things\n  // like relative protocol URLs (e.g. \"//google.com\").\n  // To workaround all of these issues, we reparse with the full URL from the\n  // `href` property.\n  if (url.charAt(0) == '.' || url.charAt(0) == '/') return parseUrl(a.href);\n\n  // Don't include default ports.\n  let port = (a.port == HTTP_PORT || a.port == HTTPS_PORT) ? '' : a.port;\n\n  // PhantomJS sets the port to \"0\" when using the file: protocol.\n  port = port == '0' ? '' : port;\n\n  // Sometimes IE incorrectly includes a port for default ports\n  // (e.g. `:80` or `:443`) even when no port is specified in the URL.\n  // http://bit.ly/1rQNoMg\n  const host = a.host.replace(DEFAULT_PORT, '');\n\n  // Not all browser support `origin` so we have to build it.\n  const origin = a.origin ? a.origin : a.protocol + '//' + host;\n\n  // Sometimes IE doesn't include the leading slash for pathname.\n  // http://bit.ly/1rQNoMg\n  const pathname = a.pathname.charAt(0) == '/' ? a.pathname : '/' + a.pathname;\n\n  return cache[url] = {\n    hash: a.hash,\n    host: host,\n    hostname: a.hostname,\n    href: a.href,\n    origin: origin,\n    pathname: pathname,\n    port: port,\n    protocol: a.protocol,\n    search: a.search,\n  };\n}\n","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n","'use strict';\n\nvar index = function (element, ref) {\n  if ( ref === void 0 ) ref = {};\n  var offset = ref.offset; if ( offset === void 0 ) offset = 0;\n  var threshold = ref.threshold; if ( threshold === void 0 ) threshold = 0;\n\n  var ref$1 = element.getBoundingClientRect();\n  var top = ref$1.top;\n  var right = ref$1.right;\n  var bottom = ref$1.bottom;\n  var left = ref$1.left;\n  var width = ref$1.width;\n  var height = ref$1.height;\n\n  var intersection = {\n    t: bottom,\n    r: window.innerWidth - left,\n    b: window.innerHeight - top,\n    l: right\n  };\n\n  var elementThreshold = {\n    x: threshold * width,\n    y: threshold * height\n  };\n\n  return (\n    intersection.t >= (offset.top || offset + elementThreshold.y) &&\n    intersection.r >= (offset.right || offset + elementThreshold.x) &&\n    intersection.b >= (offset.bottom || offset + elementThreshold.y) &&\n    intersection.l >= (offset.left || offset + elementThreshold.x)\n  )\n};\n\nmodule.exports = index;\n","import inView from 'element-in-view';\nimport throttle from 'lodash.throttle';\n\nexport default function legacy() {\n  const attr = 'data-fortnight-view';\n\n  const getPendingElements = () => document.querySelectorAll(`[${attr}=\"pending\"]`);\n\n  const loadBeacon = (node) => {\n    if (inView(node)) {\n      node.setAttribute(attr, 'sent');\n      const src = node.getAttribute('data-fortnight-beacon');\n      if (src) {\n        const a = document.createElement('a');\n        a.href = src;\n        const now = Date.now();\n        const qs = (a.search) ? `${a.search}&_=${now}` : `?_=${now}`;\n        a.search = qs;\n        const img = new Image();\n        img.src = a.href;\n      }\n    }\n  };\n\n  const handler = throttle(() => {\n    /**\n     * Find all in-view, pending elements and send\n     */\n    getPendingElements().forEach(loadBeacon);\n  }, 200);\n\n  document.addEventListener('DOMContentLoaded', () => {\n    /**\n     * On initial page load, find all pending elements and load the beacon, if in view.\n     */\n    getPendingElements().forEach(loadBeacon);\n\n    if (window.MutationObserver) {\n      /**\n       * When new nodes are added, check for pending attribute.\n       * If in-view, fire.\n       */\n      new MutationObserver((mutations) => {\n        mutations.forEach((mutation) => {\n          if (mutation.type === 'childList') {\n            Array.prototype.slice.call(mutation.addedNodes)\n              .filter(node => node.nodeType === Node.ELEMENT_NODE)\n              .filter(node => node.getAttribute(attr) === 'pending')\n              .forEach(loadBeacon);\n          }\n        });\n      }).observe(document.body, { childList: true, subtree: true });\n    }\n  });\n\n  window.addEventListener('scroll', handler);\n  window.addEventListener('resize', handler);\n}\n","/**\n * Copyright 2016 Google Inc. All Rights Reserved.\n *\n * Licensed under the W3C SOFTWARE AND DOCUMENT NOTICE AND LICENSE.\n *\n *  https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document\n *\n */\n\n(function(window, document) {\n'use strict';\n\n\n// Exits early if all IntersectionObserver and IntersectionObserverEntry\n// features are natively supported.\nif ('IntersectionObserver' in window &&\n    'IntersectionObserverEntry' in window &&\n    'intersectionRatio' in window.IntersectionObserverEntry.prototype) {\n\n  // Minimal polyfill for Edge 15's lack of `isIntersecting`\n  // See: https://github.com/w3c/IntersectionObserver/issues/211\n  if (!('isIntersecting' in window.IntersectionObserverEntry.prototype)) {\n    Object.defineProperty(window.IntersectionObserverEntry.prototype,\n      'isIntersecting', {\n      get: function () {\n        return this.intersectionRatio > 0;\n      }\n    });\n  }\n  return;\n}\n\n\n/**\n * An IntersectionObserver registry. This registry exists to hold a strong\n * reference to IntersectionObserver instances currently observering a target\n * element. Without this registry, instances without another reference may be\n * garbage collected.\n */\nvar registry = [];\n\n\n/**\n * Creates the global IntersectionObserverEntry constructor.\n * https://w3c.github.io/IntersectionObserver/#intersection-observer-entry\n * @param {Object} entry A dictionary of instance properties.\n * @constructor\n */\nfunction IntersectionObserverEntry(entry) {\n  this.time = entry.time;\n  this.target = entry.target;\n  this.rootBounds = entry.rootBounds;\n  this.boundingClientRect = entry.boundingClientRect;\n  this.intersectionRect = entry.intersectionRect || getEmptyRect();\n  this.isIntersecting = !!entry.intersectionRect;\n\n  // Calculates the intersection ratio.\n  var targetRect = this.boundingClientRect;\n  var targetArea = targetRect.width * targetRect.height;\n  var intersectionRect = this.intersectionRect;\n  var intersectionArea = intersectionRect.width * intersectionRect.height;\n\n  // Sets intersection ratio.\n  if (targetArea) {\n    this.intersectionRatio = intersectionArea / targetArea;\n  } else {\n    // If area is zero and is intersecting, sets to 1, otherwise to 0\n    this.intersectionRatio = this.isIntersecting ? 1 : 0;\n  }\n}\n\n\n/**\n * Creates the global IntersectionObserver constructor.\n * https://w3c.github.io/IntersectionObserver/#intersection-observer-interface\n * @param {Function} callback The function to be invoked after intersection\n *     changes have queued. The function is not invoked if the queue has\n *     been emptied by calling the `takeRecords` method.\n * @param {Object=} opt_options Optional configuration options.\n * @constructor\n */\nfunction IntersectionObserver(callback, opt_options) {\n\n  var options = opt_options || {};\n\n  if (typeof callback != 'function') {\n    throw new Error('callback must be a function');\n  }\n\n  if (options.root && options.root.nodeType != 1) {\n    throw new Error('root must be an Element');\n  }\n\n  // Binds and throttles `this._checkForIntersections`.\n  this._checkForIntersections = throttle(\n      this._checkForIntersections.bind(this), this.THROTTLE_TIMEOUT);\n\n  // Private properties.\n  this._callback = callback;\n  this._observationTargets = [];\n  this._queuedEntries = [];\n  this._rootMarginValues = this._parseRootMargin(options.rootMargin);\n\n  // Public properties.\n  this.thresholds = this._initThresholds(options.threshold);\n  this.root = options.root || null;\n  this.rootMargin = this._rootMarginValues.map(function(margin) {\n    return margin.value + margin.unit;\n  }).join(' ');\n}\n\n\n/**\n * The minimum interval within which the document will be checked for\n * intersection changes.\n */\nIntersectionObserver.prototype.THROTTLE_TIMEOUT = 100;\n\n\n/**\n * The frequency in which the polyfill polls for intersection changes.\n * this can be updated on a per instance basis and must be set prior to\n * calling `observe` on the first target.\n */\nIntersectionObserver.prototype.POLL_INTERVAL = null;\n\n/**\n * Use a mutation observer on the root element\n * to detect intersection changes.\n */\nIntersectionObserver.prototype.USE_MUTATION_OBSERVER = true;\n\n\n/**\n * Starts observing a target element for intersection changes based on\n * the thresholds values.\n * @param {Element} target The DOM element to observe.\n */\nIntersectionObserver.prototype.observe = function(target) {\n  var isTargetAlreadyObserved = this._observationTargets.some(function(item) {\n    return item.element == target;\n  });\n\n  if (isTargetAlreadyObserved) {\n    return;\n  }\n\n  if (!(target && target.nodeType == 1)) {\n    throw new Error('target must be an Element');\n  }\n\n  this._registerInstance();\n  this._observationTargets.push({element: target, entry: null});\n  this._monitorIntersections();\n  this._checkForIntersections();\n};\n\n\n/**\n * Stops observing a target element for intersection changes.\n * @param {Element} target The DOM element to observe.\n */\nIntersectionObserver.prototype.unobserve = function(target) {\n  this._observationTargets =\n      this._observationTargets.filter(function(item) {\n\n    return item.element != target;\n  });\n  if (!this._observationTargets.length) {\n    this._unmonitorIntersections();\n    this._unregisterInstance();\n  }\n};\n\n\n/**\n * Stops observing all target elements for intersection changes.\n */\nIntersectionObserver.prototype.disconnect = function() {\n  this._observationTargets = [];\n  this._unmonitorIntersections();\n  this._unregisterInstance();\n};\n\n\n/**\n * Returns any queue entries that have not yet been reported to the\n * callback and clears the queue. This can be used in conjunction with the\n * callback to obtain the absolute most up-to-date intersection information.\n * @return {Array} The currently queued entries.\n */\nIntersectionObserver.prototype.takeRecords = function() {\n  var records = this._queuedEntries.slice();\n  this._queuedEntries = [];\n  return records;\n};\n\n\n/**\n * Accepts the threshold value from the user configuration object and\n * returns a sorted array of unique threshold values. If a value is not\n * between 0 and 1 and error is thrown.\n * @private\n * @param {Array|number=} opt_threshold An optional threshold value or\n *     a list of threshold values, defaulting to [0].\n * @return {Array} A sorted list of unique and valid threshold values.\n */\nIntersectionObserver.prototype._initThresholds = function(opt_threshold) {\n  var threshold = opt_threshold || [0];\n  if (!Array.isArray(threshold)) threshold = [threshold];\n\n  return threshold.sort().filter(function(t, i, a) {\n    if (typeof t != 'number' || isNaN(t) || t < 0 || t > 1) {\n      throw new Error('threshold must be a number between 0 and 1 inclusively');\n    }\n    return t !== a[i - 1];\n  });\n};\n\n\n/**\n * Accepts the rootMargin value from the user configuration object\n * and returns an array of the four margin values as an object containing\n * the value and unit properties. If any of the values are not properly\n * formatted or use a unit other than px or %, and error is thrown.\n * @private\n * @param {string=} opt_rootMargin An optional rootMargin value,\n *     defaulting to '0px'.\n * @return {Array<Object>} An array of margin objects with the keys\n *     value and unit.\n */\nIntersectionObserver.prototype._parseRootMargin = function(opt_rootMargin) {\n  var marginString = opt_rootMargin || '0px';\n  var margins = marginString.split(/\\s+/).map(function(margin) {\n    var parts = /^(-?\\d*\\.?\\d+)(px|%)$/.exec(margin);\n    if (!parts) {\n      throw new Error('rootMargin must be specified in pixels or percent');\n    }\n    return {value: parseFloat(parts[1]), unit: parts[2]};\n  });\n\n  // Handles shorthand.\n  margins[1] = margins[1] || margins[0];\n  margins[2] = margins[2] || margins[0];\n  margins[3] = margins[3] || margins[1];\n\n  return margins;\n};\n\n\n/**\n * Starts polling for intersection changes if the polling is not already\n * happening, and if the page's visibilty state is visible.\n * @private\n */\nIntersectionObserver.prototype._monitorIntersections = function() {\n  if (!this._monitoringIntersections) {\n    this._monitoringIntersections = true;\n\n    // If a poll interval is set, use polling instead of listening to\n    // resize and scroll events or DOM mutations.\n    if (this.POLL_INTERVAL) {\n      this._monitoringInterval = setInterval(\n          this._checkForIntersections, this.POLL_INTERVAL);\n    }\n    else {\n      addEvent(window, 'resize', this._checkForIntersections, true);\n      addEvent(document, 'scroll', this._checkForIntersections, true);\n\n      if (this.USE_MUTATION_OBSERVER && 'MutationObserver' in window) {\n        this._domObserver = new MutationObserver(this._checkForIntersections);\n        this._domObserver.observe(document, {\n          attributes: true,\n          childList: true,\n          characterData: true,\n          subtree: true\n        });\n      }\n    }\n  }\n};\n\n\n/**\n * Stops polling for intersection changes.\n * @private\n */\nIntersectionObserver.prototype._unmonitorIntersections = function() {\n  if (this._monitoringIntersections) {\n    this._monitoringIntersections = false;\n\n    clearInterval(this._monitoringInterval);\n    this._monitoringInterval = null;\n\n    removeEvent(window, 'resize', this._checkForIntersections, true);\n    removeEvent(document, 'scroll', this._checkForIntersections, true);\n\n    if (this._domObserver) {\n      this._domObserver.disconnect();\n      this._domObserver = null;\n    }\n  }\n};\n\n\n/**\n * Scans each observation target for intersection changes and adds them\n * to the internal entries queue. If new entries are found, it\n * schedules the callback to be invoked.\n * @private\n */\nIntersectionObserver.prototype._checkForIntersections = function() {\n  var rootIsInDom = this._rootIsInDom();\n  var rootRect = rootIsInDom ? this._getRootRect() : getEmptyRect();\n\n  this._observationTargets.forEach(function(item) {\n    var target = item.element;\n    var targetRect = getBoundingClientRect(target);\n    var rootContainsTarget = this._rootContainsTarget(target);\n    var oldEntry = item.entry;\n    var intersectionRect = rootIsInDom && rootContainsTarget &&\n        this._computeTargetAndRootIntersection(target, rootRect);\n\n    var newEntry = item.entry = new IntersectionObserverEntry({\n      time: now(),\n      target: target,\n      boundingClientRect: targetRect,\n      rootBounds: rootRect,\n      intersectionRect: intersectionRect\n    });\n\n    if (!oldEntry) {\n      this._queuedEntries.push(newEntry);\n    } else if (rootIsInDom && rootContainsTarget) {\n      // If the new entry intersection ratio has crossed any of the\n      // thresholds, add a new entry.\n      if (this._hasCrossedThreshold(oldEntry, newEntry)) {\n        this._queuedEntries.push(newEntry);\n      }\n    } else {\n      // If the root is not in the DOM or target is not contained within\n      // root but the previous entry for this target had an intersection,\n      // add a new record indicating removal.\n      if (oldEntry && oldEntry.isIntersecting) {\n        this._queuedEntries.push(newEntry);\n      }\n    }\n  }, this);\n\n  if (this._queuedEntries.length) {\n    this._callback(this.takeRecords(), this);\n  }\n};\n\n\n/**\n * Accepts a target and root rect computes the intersection between then\n * following the algorithm in the spec.\n * TODO(philipwalton): at this time clip-path is not considered.\n * https://w3c.github.io/IntersectionObserver/#calculate-intersection-rect-algo\n * @param {Element} target The target DOM element\n * @param {Object} rootRect The bounding rect of the root after being\n *     expanded by the rootMargin value.\n * @return {?Object} The final intersection rect object or undefined if no\n *     intersection is found.\n * @private\n */\nIntersectionObserver.prototype._computeTargetAndRootIntersection =\n    function(target, rootRect) {\n\n  // If the element isn't displayed, an intersection can't happen.\n  if (window.getComputedStyle(target).display == 'none') return;\n\n  var targetRect = getBoundingClientRect(target);\n  var intersectionRect = targetRect;\n  var parent = getParentNode(target);\n  var atRoot = false;\n\n  while (!atRoot) {\n    var parentRect = null;\n    var parentComputedStyle = parent.nodeType == 1 ?\n        window.getComputedStyle(parent) : {};\n\n    // If the parent isn't displayed, an intersection can't happen.\n    if (parentComputedStyle.display == 'none') return;\n\n    if (parent == this.root || parent == document) {\n      atRoot = true;\n      parentRect = rootRect;\n    } else {\n      // If the element has a non-visible overflow, and it's not the <body>\n      // or <html> element, update the intersection rect.\n      // Note: <body> and <html> cannot be clipped to a rect that's not also\n      // the document rect, so no need to compute a new intersection.\n      if (parent != document.body &&\n          parent != document.documentElement &&\n          parentComputedStyle.overflow != 'visible') {\n        parentRect = getBoundingClientRect(parent);\n      }\n    }\n\n    // If either of the above conditionals set a new parentRect,\n    // calculate new intersection data.\n    if (parentRect) {\n      intersectionRect = computeRectIntersection(parentRect, intersectionRect);\n\n      if (!intersectionRect) break;\n    }\n    parent = getParentNode(parent);\n  }\n  return intersectionRect;\n};\n\n\n/**\n * Returns the root rect after being expanded by the rootMargin value.\n * @return {Object} The expanded root rect.\n * @private\n */\nIntersectionObserver.prototype._getRootRect = function() {\n  var rootRect;\n  if (this.root) {\n    rootRect = getBoundingClientRect(this.root);\n  } else {\n    // Use <html>/<body> instead of window since scroll bars affect size.\n    var html = document.documentElement;\n    var body = document.body;\n    rootRect = {\n      top: 0,\n      left: 0,\n      right: html.clientWidth || body.clientWidth,\n      width: html.clientWidth || body.clientWidth,\n      bottom: html.clientHeight || body.clientHeight,\n      height: html.clientHeight || body.clientHeight\n    };\n  }\n  return this._expandRectByRootMargin(rootRect);\n};\n\n\n/**\n * Accepts a rect and expands it by the rootMargin value.\n * @param {Object} rect The rect object to expand.\n * @return {Object} The expanded rect.\n * @private\n */\nIntersectionObserver.prototype._expandRectByRootMargin = function(rect) {\n  var margins = this._rootMarginValues.map(function(margin, i) {\n    return margin.unit == 'px' ? margin.value :\n        margin.value * (i % 2 ? rect.width : rect.height) / 100;\n  });\n  var newRect = {\n    top: rect.top - margins[0],\n    right: rect.right + margins[1],\n    bottom: rect.bottom + margins[2],\n    left: rect.left - margins[3]\n  };\n  newRect.width = newRect.right - newRect.left;\n  newRect.height = newRect.bottom - newRect.top;\n\n  return newRect;\n};\n\n\n/**\n * Accepts an old and new entry and returns true if at least one of the\n * threshold values has been crossed.\n * @param {?IntersectionObserverEntry} oldEntry The previous entry for a\n *    particular target element or null if no previous entry exists.\n * @param {IntersectionObserverEntry} newEntry The current entry for a\n *    particular target element.\n * @return {boolean} Returns true if a any threshold has been crossed.\n * @private\n */\nIntersectionObserver.prototype._hasCrossedThreshold =\n    function(oldEntry, newEntry) {\n\n  // To make comparing easier, an entry that has a ratio of 0\n  // but does not actually intersect is given a value of -1\n  var oldRatio = oldEntry && oldEntry.isIntersecting ?\n      oldEntry.intersectionRatio || 0 : -1;\n  var newRatio = newEntry.isIntersecting ?\n      newEntry.intersectionRatio || 0 : -1;\n\n  // Ignore unchanged ratios\n  if (oldRatio === newRatio) return;\n\n  for (var i = 0; i < this.thresholds.length; i++) {\n    var threshold = this.thresholds[i];\n\n    // Return true if an entry matches a threshold or if the new ratio\n    // and the old ratio are on the opposite sides of a threshold.\n    if (threshold == oldRatio || threshold == newRatio ||\n        threshold < oldRatio !== threshold < newRatio) {\n      return true;\n    }\n  }\n};\n\n\n/**\n * Returns whether or not the root element is an element and is in the DOM.\n * @return {boolean} True if the root element is an element and is in the DOM.\n * @private\n */\nIntersectionObserver.prototype._rootIsInDom = function() {\n  return !this.root || containsDeep(document, this.root);\n};\n\n\n/**\n * Returns whether or not the target element is a child of root.\n * @param {Element} target The target element to check.\n * @return {boolean} True if the target element is a child of root.\n * @private\n */\nIntersectionObserver.prototype._rootContainsTarget = function(target) {\n  return containsDeep(this.root || document, target);\n};\n\n\n/**\n * Adds the instance to the global IntersectionObserver registry if it isn't\n * already present.\n * @private\n */\nIntersectionObserver.prototype._registerInstance = function() {\n  if (registry.indexOf(this) < 0) {\n    registry.push(this);\n  }\n};\n\n\n/**\n * Removes the instance from the global IntersectionObserver registry.\n * @private\n */\nIntersectionObserver.prototype._unregisterInstance = function() {\n  var index = registry.indexOf(this);\n  if (index != -1) registry.splice(index, 1);\n};\n\n\n/**\n * Returns the result of the performance.now() method or null in browsers\n * that don't support the API.\n * @return {number} The elapsed time since the page was requested.\n */\nfunction now() {\n  return window.performance && performance.now && performance.now();\n}\n\n\n/**\n * Throttles a function and delays its executiong, so it's only called at most\n * once within a given time period.\n * @param {Function} fn The function to throttle.\n * @param {number} timeout The amount of time that must pass before the\n *     function can be called again.\n * @return {Function} The throttled function.\n */\nfunction throttle(fn, timeout) {\n  var timer = null;\n  return function () {\n    if (!timer) {\n      timer = setTimeout(function() {\n        fn();\n        timer = null;\n      }, timeout);\n    }\n  };\n}\n\n\n/**\n * Adds an event handler to a DOM node ensuring cross-browser compatibility.\n * @param {Node} node The DOM node to add the event handler to.\n * @param {string} event The event name.\n * @param {Function} fn The event handler to add.\n * @param {boolean} opt_useCapture Optionally adds the even to the capture\n *     phase. Note: this only works in modern browsers.\n */\nfunction addEvent(node, event, fn, opt_useCapture) {\n  if (typeof node.addEventListener == 'function') {\n    node.addEventListener(event, fn, opt_useCapture || false);\n  }\n  else if (typeof node.attachEvent == 'function') {\n    node.attachEvent('on' + event, fn);\n  }\n}\n\n\n/**\n * Removes a previously added event handler from a DOM node.\n * @param {Node} node The DOM node to remove the event handler from.\n * @param {string} event The event name.\n * @param {Function} fn The event handler to remove.\n * @param {boolean} opt_useCapture If the event handler was added with this\n *     flag set to true, it should be set to true here in order to remove it.\n */\nfunction removeEvent(node, event, fn, opt_useCapture) {\n  if (typeof node.removeEventListener == 'function') {\n    node.removeEventListener(event, fn, opt_useCapture || false);\n  }\n  else if (typeof node.detatchEvent == 'function') {\n    node.detatchEvent('on' + event, fn);\n  }\n}\n\n\n/**\n * Returns the intersection between two rect objects.\n * @param {Object} rect1 The first rect.\n * @param {Object} rect2 The second rect.\n * @return {?Object} The intersection rect or undefined if no intersection\n *     is found.\n */\nfunction computeRectIntersection(rect1, rect2) {\n  var top = Math.max(rect1.top, rect2.top);\n  var bottom = Math.min(rect1.bottom, rect2.bottom);\n  var left = Math.max(rect1.left, rect2.left);\n  var right = Math.min(rect1.right, rect2.right);\n  var width = right - left;\n  var height = bottom - top;\n\n  return (width >= 0 && height >= 0) && {\n    top: top,\n    bottom: bottom,\n    left: left,\n    right: right,\n    width: width,\n    height: height\n  };\n}\n\n\n/**\n * Shims the native getBoundingClientRect for compatibility with older IE.\n * @param {Element} el The element whose bounding rect to get.\n * @return {Object} The (possibly shimmed) rect of the element.\n */\nfunction getBoundingClientRect(el) {\n  var rect;\n\n  try {\n    rect = el.getBoundingClientRect();\n  } catch (err) {\n    // Ignore Windows 7 IE11 \"Unspecified error\"\n    // https://github.com/w3c/IntersectionObserver/pull/205\n  }\n\n  if (!rect) return getEmptyRect();\n\n  // Older IE\n  if (!(rect.width && rect.height)) {\n    rect = {\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      left: rect.left,\n      width: rect.right - rect.left,\n      height: rect.bottom - rect.top\n    };\n  }\n  return rect;\n}\n\n\n/**\n * Returns an empty rect object. An empty rect is returned when an element\n * is not in the DOM.\n * @return {Object} The empty rect.\n */\nfunction getEmptyRect() {\n  return {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    width: 0,\n    height: 0\n  };\n}\n\n/**\n * Checks to see if a parent element contains a child elemnt (including inside\n * shadow DOM).\n * @param {Node} parent The parent element.\n * @param {Node} child The child element.\n * @return {boolean} True if the parent node contains the child node.\n */\nfunction containsDeep(parent, child) {\n  var node = child;\n  while (node) {\n    if (node == parent) return true;\n\n    node = getParentNode(node);\n  }\n  return false;\n}\n\n\n/**\n * Gets the parent node of an element or its host element if the parent node\n * is a shadow root.\n * @param {Node} node The node whose parent to get.\n * @return {Node|null} The parent node or null if no parent exists.\n */\nfunction getParentNode(node) {\n  var parent = node.parentNode;\n\n  if (parent && parent.nodeType == 11 && parent.host) {\n    // If the parent is a shadow root, return the host element.\n    return parent.host;\n  }\n  return parent;\n}\n\n\n// Exposes the constructors globally.\nwindow.IntersectionObserver = IntersectionObserver;\nwindow.IntersectionObserverEntry = IntersectionObserverEntry;\n\n}(window, document));\n","import {\n  domReady,\n  assign,\n  extractFieldsFrom,\n  isTrackable,\n} from '../utils';\n\nrequire('intersection-observer');\n\n/**\n * Detects whether or not an intersection record is visible based on the threshold.\n *\n * @param {number} threshold\n * @param {IntersectionObserverEntry} record\n * @return {boolean}\n */\nfunction isVisible(threshold, record) {\n  if (threshold === 0) {\n    const i = record.intersectionRect;\n    return i.top > 0 || i.bottom > 0 || i.left > 0 || i.right > 0;\n  }\n  return record.intersectionRatio >= threshold;\n}\n\n/**\n * @todo We may want to explore including a MutationObserver polyfill.\n */\nexport default class ViewListener {\n  constructor(tracker, options = {}) {\n    // Disable if the browser does not support the required features.\n    if (!(window.IntersectionObserver && window.MutationObserver)) return;\n\n    const defaults = {\n      trackOnce: true,\n      threshold: 0.25,\n      rootMargin: '0px',\n    };\n    this.opts = assign(defaults, options);\n\n    // Bind methods.\n    this.handleIntersection = this.handleIntersection.bind(this);\n    this.handleMutations = this.handleMutations.bind(this);\n    this.handleAddedElement = this.handleAddedElement.bind(this);\n    this.handleRemovedElement = this.handleRemovedElement.bind(this);\n\n    this.mutationObserver = null;\n    this.intersectionObserver = null;\n\n    this.tracker = tracker;\n\n    domReady(() => {\n      this.observeElements();\n    });\n  }\n\n  static getElements() {\n    const nodes = [];\n    document.querySelectorAll('[data-fortnight-action=\"view\"]').forEach(node => nodes.push(node));\n    return nodes;\n  }\n\n  observeElements() {\n    // Setup intersection observer.\n    if (!this.intersectionObserver) {\n      this.intersectionObserver = new IntersectionObserver(this.handleIntersection, {\n        rootMargin: this.opts.rootMargin,\n        threshold: this.opts.threshold,\n      });\n      const elements = ViewListener.getElements();\n      elements.forEach(element => this.intersectionObserver.observe(element));\n    }\n\n    // Setup mutation observer.\n    if (!this.mutationObserver) {\n      this.mutationObserver = new MutationObserver(this.handleMutations);\n      this.mutationObserver.observe(document.body, {\n        childList: true,\n        subtree: true,\n      });\n    }\n\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=612323\n    requestAnimationFrame(() => {});\n  }\n\n  unobserveAllElements() {\n    this.intersectionObserver.disconnect();\n    this.intersectionObserver = null;\n\n    this.mutationObserver.disconnect();\n    this.mutationObserver = null;\n\n    this.elementMap = {};\n  }\n\n  handleIntersection(records) {\n    for (let i = 0; i < records.length; i += 1) {\n      const record = records[i];\n      if (isVisible(this.opts.threshold, record)) {\n        const node = record.target;\n        this.sendEvent(node);\n        if (this.opts.trackOnce) {\n          this.handleRemovedElement(node);\n        }\n      }\n    }\n  }\n\n  handleMutations(mutations) {\n    mutations.forEach((mutation) => {\n      const { addedNodes, removedNodes } = mutation;\n      for (let r = 0; r < removedNodes.length; r += 1) {\n        const removed = removedNodes[r];\n        this.walkTree(removed, this.handleRemovedElement);\n      }\n      for (let a = 0; a < addedNodes.length; a += 1) {\n        const added = addedNodes[a];\n        this.walkTree(added, this.handleAddedElement);\n      }\n    });\n  }\n\n  handleAddedElement(node) {\n    if (node) {\n      this.intersectionObserver.observe(node);\n    }\n  }\n\n  handleRemovedElement(node) {\n    if (node) {\n      this.intersectionObserver.unobserve(node);\n    }\n  }\n\n  walkTree(node, callback) {\n    if (isTrackable(node, 'view')) {\n      callback(node);\n    }\n    for (let i = 0; i < node.childNodes.length; i += 1) {\n      const child = node.childNodes[i];\n      this.walkTree(child, callback);\n    }\n  }\n\n  sendEvent(node) {\n    const fields = extractFieldsFrom(node);\n    this.tracker.execute('event', 'view', fields, { transport: 'beacon' });\n  }\n\n  destroy() {\n    this.unobserveAllElements();\n  }\n}\n","import { assign, buildQuery } from '../utils';\n\nconst domain = 'https://fortnight.as3.io';\n\nexport default class EventTransport {\n  /**\n   * Constructor.\n   *\n   * @param {?object} options\n   * @param {?string} options.domain The backend domain.\n   */\n  constructor(options = {}) {\n    const defaults = { domain };\n    this.options = assign(defaults, options);\n  }\n\n  /**\n   * Sends an event to the backend.\n   *\n   * @param {string} action The event action, e.g. `view`, `load` or `click`\n   * @param {object} fields The event fields\n   * @param {string} fields.pid The placement ID\n   * @param {string} fields.cid The campaign ID\n   * @param {?object} options The event options\n   * @param {?string} options.transport The transport type. Image is the default.\n   * @param {?Function} options.callback The callback to fire once complete.\n   */\n  send(\n    action,\n    { pid, cid, uuid } = {},\n    { transport, callback } = {},\n  ) {\n    const act = String(action).trim().toLowerCase();\n    if (!act) return;\n    const _ = (new Date()).getTime();\n    const params = {\n      pid,\n      cid,\n      uuid,\n      _,\n    };\n    const query = buildQuery(params);\n    const endpoint = `/e/${act}.gif?${query}`;\n    const url = this.createUrl(endpoint);\n\n    if (transport === 'beacon' && navigator.sendBeacon) {\n      if (typeof callback === 'function') callback(act, params);\n      navigator.sendBeacon(url);\n    } else {\n      const img = document.createElement('img');\n      if (typeof callback === 'function') {\n        img.onload = () => callback(act, params);\n        img.onerror = () => callback(act, params);\n      }\n      img.src = url;\n    }\n  }\n\n  /**\n   * Configures the domain name for sending events.\n   *\n   * @return string\n   */\n  get domain() {\n    if (!this.options.domain) return '';\n    return `${this.options.domain.replace(/\\/+$/, '')}`;\n  }\n\n  /**\n   * Creates a URL using the provided endoint with the configured domain.\n   *\n   * @param {string} endpoint\n   * @return {string}\n   */\n  createUrl(endpoint) {\n    return `${this.domain}/${endpoint.replace(/^\\/+/, '')}`;\n  }\n}\n","import { delegate, parseUrl } from 'dom-utils';\nimport {\n  withTimeout,\n  assign,\n  extractFieldsFrom,\n  isTrackable,\n} from '../utils';\n\n/**\n * Determines if a link click event will cause the current page to unload.\n * @todo Need to determine if link is opened via the context menu.\n *\n * @param {Event} event\n * @param {Element} link\n * @return {boolean}\n */\nfunction linkWillUnloadPage(event, link) {\n  return !(\n    // Only look a click events that will not open a new window or tab\n    event.type !== 'click' || link.target === '_blank' ||\n    // Cmd+Click (Mac) and Ctrl+Click (Windows) opens a new tab\n    // Shift+Click opens a new window in Chrome/Firefox, in Safari it adds to favorites\n    // Opt+Click (Mac) is used to download\n    event.metaKey || event.ctrlKey || event.shiftKey || event.altKey ||\n    // Middle mouse clicks (2) open link in new tab\n    // Right clicks (3) on Firefox trigger a click event\n    event.which > 1\n  );\n}\n\nexport default class LinkListener {\n  /**\n   *\n   * @param {Tracker} tracker\n   * @param {object} options\n   */\n  constructor(tracker, options = {}) {\n    // Prevent execution when disabled or unsupported\n    if (!options.enabled || !window.addEventListener) return;\n\n    this.tracker = tracker;\n    const defaults = {\n      events: ['click'],\n      selector: 'a',\n      shouldTrackLink: LinkListener.shouldTrackLink,\n      callback: undefined,\n    };\n    this.opts = assign(defaults, options);\n\n    this.handleInteractions = this.handleInteractions.bind(this);\n\n    this.delegates = {};\n    this.opts.events.forEach((event) => {\n      this.delegates[event] = delegate(\n        document,\n        event,\n        this.opts.selector,\n        this.handleInteractions,\n        { composed: true, useCapture: true },\n      );\n    });\n  }\n\n  handleInteractions(event, link) {\n    if (this.opts.shouldTrackLink(link, parseUrl)) {\n      const href = link.getAttribute('href');\n      const fields = extractFieldsFrom(link);\n\n      const eventOpts = {\n        transport: 'beacon',\n        callback: this.opts.callback,\n      };\n\n      const supportsBeacon = navigator.sendBeacon || false;\n      if (!supportsBeacon && linkWillUnloadPage(event, link)) {\n        // The page will unload. Pause the transition and send the event.\n        const handler = () => {\n          window.removeEventListener('click', handler);\n\n          if (!event.defaultPrevented) {\n            event.preventDefault();\n\n            // @todo What happens when the user-land code already does something similar?\n            // For example, an event listener is previously attached to the link, that also\n            // triggers a window.location call. Wouldn't that prevent the event from\n            // being tracked?\n            const original = eventOpts.callback;\n            eventOpts.callback = withTimeout((...args) => {\n              if (typeof original === 'function') original(...args);\n              window.location.href = href;\n            });\n          }\n          this.tracker.execute('event', 'click', fields, eventOpts);\n        };\n        window.addEventListener('click', handler);\n      } else {\n        // Send the event directly.\n        this.tracker.execute('event', 'click', fields, eventOpts);\n      }\n    }\n  }\n\n  /**\n   * Determines if the link should be tracked.\n   *\n   * @param {Element} element\n   * @param {Function} urlParser\n   * @return {boolean}\n   */\n  static shouldTrackLink(element, urlParser) {\n    const href = element.getAttribute('href');\n    const url = urlParser(href);\n    return url.protocol.slice(0, 4) === 'http' && isTrackable(element, 'click');\n  }\n\n  /**\n   * Destroys all event listeners.\n   */\n  destroy() {\n    Object.keys(this.delegates).forEach(key => this.delegates[key].destroy());\n  }\n}\n","import { assign } from '../utils';\nimport LinkListener from './link-listener';\nimport EventTransport from './event-transport';\nimport ViewListener from './view-listener';\n\nconst listeners = [];\n\nexport default class Tracker {\n  /**\n   * Constructor.\n   *\n   * @param {?object} options\n   * @param {boolean} [options.trackLinks=true] Whether to track links.\n   */\n  constructor(options = {}) {\n    const defaults = {\n      trackLinks: true,\n      debug: false,\n      onLinkTrack: undefined,\n    };\n    const opts = assign(defaults, options);\n    this.opts = opts;\n\n    const transport = new EventTransport({ domain: opts.domain });\n    this.commands = {\n      event: transport.send.bind(transport),\n    };\n    listeners.push(new LinkListener(this, {\n      enabled: opts.trackLinks,\n      callback: opts.onLinkTrack,\n    }));\n    listeners.push(new ViewListener(this, {}));\n  }\n\n  /**\n   * Executes a command on the tracker.\n   *\n   * @param {string} command\n   * @param {...object} args\n   */\n  execute(command, ...args) {\n    if (this.commands[command]) {\n      if (this.opts.debug) {\n        // eslint-disable-next-line no-console\n        console.info('FORTNIGHT', 'Tracker.execute', command, ...args);\n      }\n      this.commands[command](...args);\n    }\n  }\n\n  /**\n   * The tracker instance is being destroyed.\n   * Destroy all event listeners.\n   */\n  destroy() { // eslint-disable-line class-methods-use-this\n    listeners.forEach(listener => listener.destroy());\n  }\n}\n","import Tracker from './tracker';\n\nlet tracker;\nexport default function app(command, ...args) {\n  if (command === 'init') {\n    if (!tracker) tracker = new Tracker(...args);\n  } else if (command === 'destroy') {\n    if (tracker) {\n      tracker.destroy();\n      tracker = undefined;\n    }\n  } else {\n    if (!tracker) throw new Error('No Fortnight instance has been initialized.');\n    tracker.execute(command, ...args);\n  }\n}\n","import app from './app';\nimport legacy from './legacy';\n\n// Execute legacy tracker. Remove once tested.\nlegacy();\n\n// Find the command queue in the `window` object.\nconst WINDOW_VAR_NAME = 'FortnightObject';\nconst queueName = window[WINDOW_VAR_NAME];\nif (!queueName || !window[queueName]) {\n  throw new Error(`No ${WINDOW_VAR_NAME} object was found or initialized. Was the proper JavaScript included on the page?`);\n}\nconst commandQueue = window[queueName];\n\n// Apply the queue to the app.\nconst queue = commandQueue.q;\nif (Array.isArray(queue)) {\n  // Find and send the init commands first, in case the user sent the commands out of order.\n  queue.filter(args => args[0] === 'init').forEach(args => app(...args));\n  // Send all other commands.\n  queue.filter(args => args[0] !== 'init').forEach(args => app(...args));\n}\n\n// Replace the queue with the app.\nwindow[queueName] = app;\n"],"sourceRoot":""}